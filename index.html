<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Para Mi Amor â¤ï¸</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
*{
    box-sizing:border-box;
    font-family:'Segoe UI', sans-serif;
    -webkit-tap-highlight-color: transparent;
}

body, button, .control-btn{
    touch-action: manipulation;
    user-select: none;
    -webkit-user-select: none;
    -webkit-touch-callout: none;
}

body{
    margin:0;
    min-height:100vh;
    background:#000;
    display:flex;
    justify-content:center;
    align-items:center;
    color:white;
    overflow:hidden;
}

#lockScreen{
    position:fixed;
    inset:0;
    background:linear-gradient(135deg,#ff5f9e,#4b003d);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:20;
}

.lock-box{
    background:rgba(0,0,0,.5);
    padding:25px;
    border-radius:20px;
    width:90%;
    max-width:380px;
    text-align:center;
}

#gameContainer{
    display:none;
    flex-direction:column;
    align-items:center;
    gap:12px;
    width:100%;
    max-width:420px;
    padding:15px;
    background-image:url("1.jpeg");
    background-size:cover;
    background-position:center;
    border-radius:25px;
    box-shadow:0 0 40px rgba(255,0,120,.6);
}

#overlay{
    width:100%;
    background:rgba(0,0,0,.55);
    border-radius:20px;
    padding:10px;
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:10px;
}

#score{font-size:1.2em;}

canvas{
    width:90vw;
    max-width:360px;
    aspect-ratio:1/1;
    background:#120016;
    border-radius:18px;
}

#controls{
    display:grid;
    grid-template-columns:repeat(3,60px);
    grid-template-rows:repeat(3,60px);
    gap:10px;
}

.control-btn{
    background:#ff5fa2;
    border-radius:15px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:1.4em;
}

.control-btn:active{background:#ff8fc7;}

#gameOver{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.85);
    display:none;
    align-items:center;
    justify-content:center;
    z-index:15;
}

.gameover-box{
    background:#2b002b;
    padding:25px;
    border-radius:20px;
    text-align:center;
}

#poemScreen{
    position:fixed;
    inset:0;
    background-image:url("1.jpeg");
    background-size:cover;
    background-position:center;
    display:none;
    align-items:center;
    justify-content:center;
    padding:20px;
    z-index:10;
}

#poemOverlay{
    position:absolute;
    inset:0;
    background:rgba(0,0,0,.65);
}

.poem-box{
    position:relative;
    z-index:5;
    background:rgba(0,0,0,.55);
    padding:25px;
    border-radius:25px;
    text-align:center;
    max-width:500px;
    max-height:85vh;
    overflow-y:auto;
    -webkit-overflow-scrolling: touch;
}

.heart{
    position:absolute;
    top:-10%;
    color:#ff5fa2;
    font-size:18px;
    animation:fall linear infinite;
    opacity:.8;
}

@keyframes fall{
    to{
        transform:translateY(120vh);
        opacity:0;
    }
}
</style>
</head>

<body>

<div id="lockScreen">
    <div class="lock-box">
        <h2>ğŸ”’ Antes de comenzar</h2>
        <p>Â¿QuÃ© cantante favorito vimos juntos?</p>
        <input id="password" placeholder="Respuesta â¤ï¸">
        <button onclick="checkPassword()">Entrar</button>
    </div>
</div>

<div id="gameContainer">
    <div id="overlay">
        <div id="score">â¤ï¸ 2 / 20</div>
        <canvas id="game"></canvas>

        <div id="controls">
            <div></div>
            <div class="control-btn" data-x="0" data-y="-1">â¬†ï¸</div>
            <div></div>
            <div class="control-btn" data-x="-1" data-y="0">â¬…ï¸</div>
            <div class="control-btn">â¤ï¸</div>
            <div class="control-btn" data-x="1" data-y="0">â¡ï¸</div>
            <div></div>
            <div class="control-btn" data-x="0" data-y="1">â¬‡ï¸</div>
            <div></div>
        </div>
    </div>
</div>

<div id="gameOver">
    <div class="gameover-box">
        <h2>ğŸ’” Te chocaste contigo amor</h2>
        <button onclick="restartGame()">Reintentar</button>
    </div>
</div>

<div id="poemScreen">
    <div id="poemOverlay"></div>
    <div class="poem-box">
        <h2>Para ti, mi Amorcito ğŸ’•</h2>
        <p>
        Buenos dÃ­as, amorshito â˜€ï¸ğŸ’– por fin puedo decir  
        que hoy estarÃ© en tus brazos ğŸ¤, para cuidarte,  
        inundarte de besitos ğŸ˜˜, ayudarte y llenarte de amor ğŸ’«.<br><br>

        Amor, no prometo que tus dÃ­as serÃ¡n color de rosa ğŸŒ¸,  
        pero sÃ­ sÃ© que harÃ© lo que sea para pintar tus dÃ­as de colores ğŸ¨âœ¨.  
        Amor, no prometo que tendremos dÃ­as mÃ¡gicos ğŸª„,  
        pero harÃ© que cada dÃ­a sea mÃ¡gico con nuestro amor ğŸ’.<br><br>

        Si estÃ¡s estresadita, estarÃ© ahÃ­ para darte tus masajitos ğŸ¤²ğŸ’†â€â™€ï¸,  
        si tienes deseos, quiero ser quien los cumpla ğŸŒ .  
        Si quieres que baje y traiga las estrellas âœ¨ğŸŒŒ,  
        lo harÃ© para que, a tu lado, el universo se complete ğŸ’«.<br><br>

        Atte. Gregory ğŸ’Œ <em>(con su media neurona ğŸ¤­)</em>
        </p>
    </div>
</div>

<audio id="musicGame" src="musica1.mp3" loop></audio>
<audio id="musicPoem" src="musica2.mp3" loop></audio>

<script>
document.addEventListener("contextmenu", e => e.preventDefault());

const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

let size, grid=18, snake, food, dir, score, loop, speed=160;

function resize(){
    size=Math.min(window.innerWidth*0.9,360);
    canvas.width=size;
    canvas.height=size;
}
resize();
window.addEventListener("resize",resize);

function checkPassword(){
    if(password.value.trim().toLowerCase()==="joseca"){
        lockScreen.style.display="none";
        gameContainer.style.display="flex";
        musicGame.play();
        startGame();
    }
}

function startGame(){
    snake=[
        {x:9,y:9},
        {x:8,y:9},
        {x:7,y:9}
    ];
    dir={x:1,y:0};
    food=randomFood();
    score=2;
    updateScore();
    clearInterval(loop);
    loop=setInterval(update,speed);
}

function randomFood(){
    return {x:Math.floor(Math.random()*grid),y:Math.floor(Math.random()*grid)};
}

function setDir(x,y){
    if(dir.x!==-x && dir.y!==-y) dir={x,y};
}

function update(){
    let h={x:snake[0].x+dir.x,y:snake[0].y+dir.y};

    if(h.x<0) h.x=grid-1;
    if(h.x>=grid) h.x=0;
    if(h.y<0) h.y=grid-1;
    if(h.y>=grid) h.y=0;

    if(snake.some((s,i)=>i&&s.x===h.x&&s.y===h.y)){
        clearInterval(loop);
        gameOver.style.display="flex";
        return;
    }

    snake.unshift(h);

    if(h.x===food.x && h.y===food.y){
        score++;
        updateScore();
        food=randomFood();
        if(score>=20){
            clearInterval(loop);
            musicGame.pause();
            musicPoem.play();
            gameContainer.style.display="none";
            poemScreen.style.display="flex";
            startHeartRain();
            return;
        }
    }else snake.pop();

    draw();
}

function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    const cell=canvas.width/grid;
    ctx.font=`${cell}px Arial`;
    ctx.fillText("â¤ï¸",food.x*cell,food.y*cell+cell);
    snake.forEach((s,i)=>{
        ctx.fillStyle=i?"#ff8fc7":"#ff5fa2";
        ctx.fillRect(s.x*cell,s.y*cell,cell-2,cell-2);
    });
}

function updateScore(){
    scoreEl.innerText=`â¤ï¸ ${score} / 20`;
}
const scoreEl=document.getElementById("score");

function restartGame(){
    gameOver.style.display="none";
    startGame();
}

function startHeartRain(){
    for(let i=0;i<30;i++){
        const heart=document.createElement("div");
        heart.className="heart";
        heart.innerText="â¤ï¸";
        heart.style.left=Math.random()*100+"vw";
        heart.style.animationDuration=3+Math.random()*4+"s";
        heart.style.fontSize=16+Math.random()*20+"px";
        poemScreen.appendChild(heart);
    }
}

// ğŸš€ CONTROLES SIN RETARDO
document.querySelectorAll(".control-btn").forEach(btn=>{
    const x=btn.dataset.x;
    const y=btn.dataset.y;
    if(x && y){
        const move=e=>{
            e.preventDefault();
            setDir(parseInt(x),parseInt(y));
        };
        btn.addEventListener("touchstart",move,{passive:false});
        btn.addEventListener("mousedown",move);
    }
});
</script>

</body>
</html>
